[
  {
    "path": "posts/2021-04-20-soil-analysis/",
    "title": "Soil Analysis",
    "description": "Soil analysis of soil survey from the North of Thailand",
    "author": [
      {
        "name": "Sith Jaisong",
        "url": {}
      }
    ],
    "date": "2021-04-20",
    "categories": [
      "Rstat",
      "Rice research"
    ],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nReveal of data\r\nEDA\r\nIntra- and interspecific variation Exploration of soil types\r\n\r\nIntroduction\r\nThe project of soil profiles collected from rice planting areas in the north of Thailand was established from 2016 - 2019. The details will be shown below.\r\nReveal of data\r\n\r\n\r\n# load library\r\nlibrary(here)\r\nlibrary(tidyverse)\r\nlibrary(tidyr)\r\nlibrary(recipes)\r\nlibrary(corrplot)\r\nlibrary(ggpubr)\r\nlibrary(Rmisc)\r\nlibrary(vegan)\r\nlibrary(ggpubr)\r\nlibrary(GGally)\r\nlibrary(RColorBrewer)\r\n\r\ndatabase <- read_csv(\r\n  file = here::here(\"_posts\", \"2021-04-20-soil-analysis\" ,\"data\", \"database.csv\")\r\n  )\r\n#glimpse(database) # if you want to see the original data\r\n\r\n\r\n\r\nThen, we should remove columns containing Thai letter due to not supported by R\r\n\r\n\r\ndatabase.cleaned <- database %>%\r\n  select(-run,\r\n         -`lab no`,\r\n         -transplant,\r\n         -var,\r\n         -tam,\r\n         -amphoe,\r\n         -prov,\r\n         -seriesname,\r\n         -from) %>%\r\n  mutate(\r\n    pH = as.numeric(pH),\r\n    om = as.numeric(om),\r\n    P = as.numeric(P),\r\n    K = as.numeric(K),\r\n    sand = as.numeric(sand),\r\n    silt = as.numeric(silt),\r\n    clay = as.numeric(clay),\r\n    texture = as.factor(texture),\r\n    soilseries = as.factor(soilseries),\r\n    suit = as.factor(suit),\r\n    text.code = as.factor(text.code),\r\n    se.tex = as.factor(se.tex)\r\n  )\r\ndatabase.cleaned\r\n\r\n\r\n# A tibble: 1,964 x 15\r\n      pH    om     P     K  sand  silt  clay texture       no     x1\r\n   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <fct>      <dbl>  <dbl>\r\n 1  6.01  2.73    35   133  46.4  33.7  19.9 loam         554 701861\r\n 2  5.89  2.92    31   119  46.6  33.6  19.8 loam         555 701861\r\n 3  4.54  2.85    37   102  45    31.6  23.4 loam        1019 639483\r\n 4  4.93  1.93    15    92  50    28    22   loam        1888 521167\r\n 5  6.51  3.05    71   142  48.5  29.5  22   loam        1475 624104\r\n 6  6.51  3.05    71   142  48.5  29.5  22   loam        1476 624104\r\n 7  5.44  4.07    19   107  42.4  37.6  20   loam        2030 535134\r\n 8  5.1   0.93     9    94  78.8  13.6   7.6 loamy sand  1965 512267\r\n 9  5.65  1.19     6    95  84    10     6   loamy sand  1977 512097\r\n10  6.2   1.29     7    45  78    14     8   loamy sand  1978 512097\r\n# ... with 1,954 more rows, and 5 more variables: y1 <dbl>,\r\n#   soilseries <fct>, suit <fct>, text.code <fct>, se.tex <fct>\r\n\r\nEDA\r\nShall we look at data distribution of each variables by histograms.\r\n\r\n\r\nlibrary(DataExplorer)\r\ndatabase.cleaned %>%\r\n  select(pH, om, P, K, sand, clay) %>%\r\n  plot_histogram() + facet_grid(soilseries ~ text.code)\r\n\r\n\r\n\r\nNULL\r\n\r\nClay, OM, pH and sand were all tend to be normal distributed except K and P. So, in any soil types, pH was not vary.\r\nTo compare soil properties in each of suitable soil levels. I would rather to show mean of each factor with 95%CI errorbar.\r\n\r\n\r\nmy_sum_suit <- database.cleaned %>%\r\n  select(pH, om, P, K, sand, silt, clay, suit) %>%\r\n  gather(key = \"soil_prop\", value = \"measurement\",-suit) %>%\r\n  summarySE(\r\n    measurevar = \"measurement\",\r\n    groupvars = c(\"suit\", \"soil_prop\"),\r\n    conf.interval = 0.95,\r\n    na.rm = TRUE,\r\n    .drop = TRUE\r\n  )\r\n\r\nmy_sum_suit %>% ggplot(aes(x = suit, y = measurement)) +\r\n  geom_point(size = 2) +\r\n  geom_errorbar(width = 0, size = 1, aes(\r\n    ymin = measurement - ci,\r\n    ymax = measurement + ci\r\n  )) +\r\n  facet_wrap(~soil_prop, scales = \"free\") + theme_bw()\r\n\r\n\r\n\r\n\r\nHere take a look soil properties at each soil series\r\n\r\n\r\nmy_sum_soilseries <- database.cleaned %>%\r\n  select(pH, om, P, K, sand, silt, clay, soilseries, text.code) %>%\r\n  gather(key = \"soil_prop\", value = \"measurement\", -soilseries, - text.code) %>%\r\n  summarySE(\r\n    measurevar = \"measurement\",\r\n    groupvars = c(\"soilseries\", \"soil_prop\", \"text.code\"),\r\n    conf.interval = 0.95,\r\n    na.rm = TRUE,\r\n    .drop = TRUE\r\n  )\r\n\r\nmy_sum_soilseries %>% ggplot(aes(x = soilseries, y = measurement)) +\r\n  geom_point(size = 2) +\r\n  geom_errorbar(width = 0,\r\n                size = 1,\r\n                aes(ymin = measurement - ci,\r\n                    ymax = measurement + ci)) +\r\n  facet_grid(soil_prop ~  text.code , scales = \"free\") + theme_bw()\r\n\r\n\r\n\r\n\r\n##Check correlation of each parameters\r\n\r\n\r\ndatabase.cleaned %>%\r\n  select(pH, om, P, K, sand, clay, suit) %>%\r\n  GGally::ggpairs(aes(color = suit),\r\n          columns = c(\"pH\", \"om\", \r\n                      \"P\", \"K\", \"sand\", \"clay\"))  + scale_color_brewer(palette = \"Spectral\") +\r\n scale_fill_brewer(palette = \"Spectral\")\r\n\r\n\r\n\r\n\r\nAgain!\r\n\r\n\r\ndatabase.cleaned %>%\r\n  select(pH, om, P, K, sand, clay) %>%\r\n  plot_correlation()\r\n\r\n\r\n\r\n\r\nAgain!\r\n\r\n\r\nlibrary(lsr)\r\nlibrary(corrr)\r\n\r\ndatabase.cleaned %>% select(pH:clay) %>%\r\n  correlate() %>%\r\n  rearrange() %>%\r\n  shave() %>%\r\n  rplot()\r\n\r\n\r\n\r\n\r\npH is not very affected on any factor in soil properties. om is likely to related to clay, sand, and K. P is related to K. K is related to om, and P. sand is negatively related to clay, and om. clay is related to sand and om. we can ignore pH in the analysis.\r\nIntra- and interspecific variation Exploration of soil types\r\nHow to find the get fractional of varaince explained from ANOVA which is multiple R square at https://www.sfu.ca/~jackd/Stat302/Wk07-1_Full.pdf\r\n\r\n\r\n#follow thai papaer Intra- and interspecific variation in wood density and fine-scale spatial distribution of stand-level wood density in a northern Thai tropical monta\r\n\r\n# at pH\r\nlm(pH ~ suit, data = database.cleaned) %>% summary() # check at Multiple R square 0.01164\r\n\r\n\r\n\r\nCall:\r\nlm(formula = pH ~ suit, data = database.cleaned)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-1.6746 -0.5564 -0.1006  0.4794  2.1094 \r\n\r\nCoefficients:\r\n             Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  5.694595   0.041555 137.039  < 2e-16 ***\r\nsuitS1       0.001852   0.048274   0.038 0.969393    \r\nsuitS2      -0.184049   0.052980  -3.474 0.000524 ***\r\nsuitS3      -0.017231   0.060440  -0.285 0.775607    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.7305 on 1960 degrees of freedom\r\nMultiple R-squared:  0.01164,   Adjusted R-squared:  0.01013 \r\nF-statistic: 7.693 on 3 and 1960 DF,  p-value: 4.135e-05\r\n\r\nlm(pH ~ soilseries, data = database.cleaned) %>% summary() # check at Multiple R square 0.08051\r\n\r\n\r\n\r\nCall:\r\nlm(formula = pH ~ soilseries, data = database.cleaned)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-1.67257 -0.50959 -0.07758  0.43985  2.07368 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)    5.80312    0.10222  56.773  < 2e-16 ***\r\nsoilseriesCr  -0.55201    0.19573  -2.820  0.00485 ** \r\nsoilseriesHc  -0.36719    0.16162  -2.272  0.02320 *  \r\nsoilseriesHd  -0.05469    0.11060  -0.494  0.62102    \r\nsoilseriesKp   0.02945    0.11845   0.249  0.80370    \r\nsoilseriesLp   0.06604    0.11428   0.578  0.56341    \r\nsoilseriesLy  -0.95713    0.33279  -2.876  0.00407 ** \r\nsoilseriesMi  -0.34812    0.36855  -0.945  0.34499    \r\nsoilseriesMkn -0.17370    0.13271  -1.309  0.19075    \r\nsoilseriesMr  -0.04093    0.15060  -0.272  0.78582    \r\nsoilseriesMs   0.12560    0.14532   0.864  0.38755    \r\nsoilseriesMt  -0.21365    0.19195  -1.113  0.26581    \r\nsoilseriesMta -0.21207    0.19195  -1.105  0.26936    \r\nsoilseriesNa  -0.34165    0.11689  -2.923  0.00351 ** \r\nsoilseriesPae  0.02941    0.13090   0.225  0.82227    \r\nsoilseriesPh  -0.62225    0.11568  -5.379 8.39e-08 ***\r\nsoilseriesSai -0.29078    0.11539  -2.520  0.01181 *  \r\nsoilseriesSC  -0.17146    0.22856  -0.750  0.45325    \r\nsoilseriesSkt -0.25066    0.11707  -2.141  0.03239 *  \r\nsoilseriesSp  -0.28681    0.19195  -1.494  0.13528    \r\nsoilseriesTph -0.01640    0.11614  -0.141  0.88773    \r\nsoilseriesU    0.02354    0.14695   0.160  0.87273    \r\nsoilseriesWch -0.13312    0.18528  -0.718  0.47254    \r\nsoilseriesWs  -0.10585    0.13988  -0.757  0.44930    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.7082 on 1940 degrees of freedom\r\nMultiple R-squared:  0.08051,   Adjusted R-squared:  0.0696 \r\nF-statistic: 7.385 on 23 and 1940 DF,  p-value: < 2.2e-16\r\n\r\n# at om\r\nlm(om ~ suit, data = database.cleaned) %>% summary() # check at Multiple R square 0.01851\r\n\r\n\r\n\r\nCall:\r\nlm(formula = om ~ suit, data = database.cleaned)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-2.2023 -0.6024 -0.0714  0.4651  3.8047 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  2.15834    0.05027  42.936  < 2e-16 ***\r\nsuitS1       0.25306    0.05840   4.333 1.54e-05 ***\r\nsuitS2      -0.01309    0.06409  -0.204    0.838    \r\nsuitS3       0.10391    0.07312   1.421    0.155    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.8836 on 1960 degrees of freedom\r\nMultiple R-squared:  0.01851,   Adjusted R-squared:  0.01701 \r\nF-statistic: 12.32 on 3 and 1960 DF,  p-value: 5.492e-08\r\n\r\nlm(om ~ soilseries, data = database.cleaned) %>% summary() # check at Multiple R square 0.1442\r\n\r\n\r\n\r\nCall:\r\nlm(formula = om ~ soilseries, data = database.cleaned)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-2.7440 -0.5383 -0.0507  0.4660  3.8898 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)    2.07393    0.11971  17.325  < 2e-16 ***\r\nsoilseriesCr   1.07820    0.22923   4.704 2.74e-06 ***\r\nsoilseriesHc   0.03148    0.18928   0.166 0.867924    \r\nsoilseriesHd   0.73004    0.12953   5.636 2.00e-08 ***\r\nsoilseriesKp   0.09420    0.13872   0.679 0.497196    \r\nsoilseriesLp  -0.03009    0.13384  -0.225 0.822163    \r\nsoilseriesLy   0.81078    0.38975   2.080 0.037633 *  \r\nsoilseriesMi   1.25694    0.43162   2.912 0.003631 ** \r\nsoilseriesMkn  0.57655    0.15543   3.710 0.000214 ***\r\nsoilseriesMr  -0.12112    0.17637  -0.687 0.492353    \r\nsoilseriesMs   0.41476    0.17019   2.437 0.014900 *  \r\nsoilseriesMt  -0.02400    0.22480  -0.107 0.914972    \r\nsoilseriesMta -0.48183    0.22480  -2.143 0.032208 *  \r\nsoilseriesNa   0.05475    0.13689   0.400 0.689252    \r\nsoilseriesPae -0.32207    0.15330  -2.101 0.035784 *  \r\nsoilseriesPh   0.33459    0.13547   2.470 0.013606 *  \r\nsoilseriesSai  0.01191    0.13513   0.088 0.929797    \r\nsoilseriesSC  -0.15873    0.26768  -0.593 0.553257    \r\nsoilseriesSkt  0.01878    0.13710   0.137 0.891043    \r\nsoilseriesSp  -0.17775    0.22480  -0.791 0.429213    \r\nsoilseriesTph  0.05083    0.13601   0.374 0.708674    \r\nsoilseriesU    0.82474    0.17209   4.792 1.77e-06 ***\r\nsoilseriesWch  1.21369    0.21699   5.593 2.55e-08 ***\r\nsoilseriesWs   0.22188    0.16382   1.354 0.175771    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.8294 on 1940 degrees of freedom\r\nMultiple R-squared:  0.1442,    Adjusted R-squared:  0.134 \r\nF-statistic: 14.21 on 23 and 1940 DF,  p-value: < 2.2e-16\r\n\r\n# at P\r\nlm(log(P) ~ suit, data = database.cleaned) %>% summary() # check at Multiple R square 0.006\r\n\r\n\r\n\r\nCall:\r\nlm(formula = log(P) ~ suit, data = database.cleaned)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-3.0839 -0.7837 -0.1453  0.6555  4.1406 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  2.92893    0.06141  47.697  < 2e-16 ***\r\nsuitS1      -0.29869    0.07134  -4.187 2.95e-05 ***\r\nsuitS2      -0.32631    0.07829  -4.168 3.21e-05 ***\r\nsuitS3       0.46746    0.08932   5.234 1.84e-07 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 1.079 on 1960 degrees of freedom\r\nMultiple R-squared:  0.06065,   Adjusted R-squared:  0.05921 \r\nF-statistic: 42.18 on 3 and 1960 DF,  p-value: < 2.2e-16\r\n\r\nlm(log(P) ~ soilseries, data = database.cleaned) %>% summary() # check at Multiple R square 0.096\r\n\r\n\r\n\r\nCall:\r\nlm(formula = log(P) ~ soilseries, data = database.cleaned)\r\n\r\nResiduals:\r\n    Min      1Q  Median      3Q     Max \r\n-2.8949 -0.7563 -0.1019  0.6342  4.1264 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)    3.12817    0.15359  20.368  < 2e-16 ***\r\nsoilseriesCr  -0.45060    0.29409  -1.532  0.12564    \r\nsoilseriesHc   0.01482    0.24284   0.061  0.95133    \r\nsoilseriesHd   0.07922    0.16619   0.477  0.63364    \r\nsoilseriesKp  -0.46469    0.17798  -2.611  0.00910 ** \r\nsoilseriesLp  -0.72365    0.17171  -4.214 2.62e-05 ***\r\nsoilseriesLy  -0.43944    0.50004  -0.879  0.37962    \r\nsoilseriesMi  -1.01159    0.55376  -1.827  0.06789 .  \r\nsoilseriesMkn -0.17611    0.19941  -0.883  0.37727    \r\nsoilseriesMr  -0.38787    0.22628  -1.714  0.08667 .  \r\nsoilseriesMs  -0.44923    0.21836  -2.057  0.03979 *  \r\nsoilseriesMt   0.26454    0.28841   0.917  0.35914    \r\nsoilseriesMta -0.95639    0.28841  -3.316  0.00093 ***\r\nsoilseriesNa  -0.29244    0.17563  -1.665  0.09606 .  \r\nsoilseriesPae -0.16920    0.19669  -0.860  0.38976    \r\nsoilseriesPh  -0.81795    0.17381  -4.706 2.70e-06 ***\r\nsoilseriesSai -0.41150    0.17337  -2.373  0.01772 *  \r\nsoilseriesSC  -0.20685    0.34343  -0.602  0.54705    \r\nsoilseriesSkt -0.80464    0.17590  -4.574 5.08e-06 ***\r\nsoilseriesSp  -0.71809    0.28841  -2.490  0.01286 *  \r\nsoilseriesTph -0.10893    0.17450  -0.624  0.53254    \r\nsoilseriesU    0.39551    0.22079   1.791  0.07340 .  \r\nsoilseriesWch  0.45451    0.27840   1.633  0.10272    \r\nsoilseriesWs  -0.51084    0.21018  -2.430  0.01517 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 1.064 on 1940 degrees of freedom\r\nMultiple R-squared:  0.09652,   Adjusted R-squared:  0.08581 \r\nF-statistic: 9.011 on 23 and 1940 DF,  p-value: < 2.2e-16\r\n\r\n# at K\r\nlm(log(K) ~ suit, data = database.cleaned) %>% summary() # check at Multiple R square 0.0004\r\n\r\n\r\n\r\nCall:\r\nlm(formula = log(K) ~ suit, data = database.cleaned)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-2.15282 -0.46001  0.05315  0.45063  2.76797 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  4.33686    0.03715 116.753   <2e-16 ***\r\nsuitS1      -0.02056    0.04315  -0.477   0.6338    \r\nsuitS2       0.01319    0.04736   0.279   0.7806    \r\nsuitS3       0.11746    0.05403   2.174   0.0298 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.653 on 1960 degrees of freedom\r\nMultiple R-squared:  0.004834,  Adjusted R-squared:  0.003311 \r\nF-statistic: 3.174 on 3 and 1960 DF,  p-value: 0.02332\r\n\r\nlm(log(K) ~ soilseries, data = database.cleaned) %>% summary() # check at Multiple R square 0.1435\r\n\r\n\r\n\r\nCall:\r\nlm(formula = log(K) ~ soilseries, data = database.cleaned)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-2.04265 -0.38666  0.02941  0.39624  2.78111 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)    4.62946    0.08789  52.676  < 2e-16 ***\r\nsoilseriesCr   0.09407    0.16829   0.559 0.576240    \r\nsoilseriesHc  -0.31710    0.13896  -2.282 0.022597 *  \r\nsoilseriesHd   0.02416    0.09509   0.254 0.799493    \r\nsoilseriesKp  -0.19675    0.10184  -1.932 0.053519 .  \r\nsoilseriesLp  -0.42708    0.09826  -4.346 1.45e-05 ***\r\nsoilseriesLy  -0.15661    0.28613  -0.547 0.584203    \r\nsoilseriesMi   0.39157    0.31687   1.236 0.216705    \r\nsoilseriesMkn -0.15480    0.11410  -1.357 0.175042    \r\nsoilseriesMr  -0.58606    0.12948  -4.526 6.37e-06 ***\r\nsoilseriesMs   0.00373    0.12495   0.030 0.976187    \r\nsoilseriesMt  -0.45812    0.16503  -2.776 0.005558 ** \r\nsoilseriesMta -0.15056    0.16503  -0.912 0.361738    \r\nsoilseriesNa  -0.78767    0.10050  -7.837 7.52e-15 ***\r\nsoilseriesPae -0.42338    0.11255  -3.762 0.000174 ***\r\nsoilseriesPh  -0.40938    0.09946  -4.116 4.02e-05 ***\r\nsoilseriesSai -0.29256    0.09921  -2.949 0.003227 ** \r\nsoilseriesSC  -0.30723    0.19652  -1.563 0.118132    \r\nsoilseriesSkt -0.54800    0.10065  -5.444 5.86e-08 ***\r\nsoilseriesSp  -0.31100    0.16503  -1.884 0.059655 .  \r\nsoilseriesTph -0.18729    0.09985  -1.876 0.060856 .  \r\nsoilseriesU    0.18577    0.12634   1.470 0.141618    \r\nsoilseriesWch  0.12523    0.15931   0.786 0.431919    \r\nsoilseriesWs  -0.13434    0.12027  -1.117 0.264122    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 0.6089 on 1940 degrees of freedom\r\nMultiple R-squared:  0.1435,    Adjusted R-squared:  0.1333 \r\nF-statistic: 14.13 on 23 and 1940 DF,  p-value: < 2.2e-16\r\n\r\n# at clay\r\nlm(clay ~ suit, data = database.cleaned) %>% summary() # check at Multiple R square 0.04\r\n\r\n\r\n\r\nCall:\r\nlm(formula = clay ~ suit, data = database.cleaned)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-17.4732  -4.9844  -0.4696   4.4551  29.2462 \r\n\r\nCoefficients:\r\n            Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)  18.8696     0.4227  44.639  < 2e-16 ***\r\nsuitS1        3.1036     0.4911   6.320 3.23e-10 ***\r\nsuitS2        1.6843     0.5389   3.125   0.0018 ** \r\nsuitS3       -1.3515     0.6148  -2.198   0.0280 *  \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 7.431 on 1960 degrees of freedom\r\nMultiple R-squared:  0.04589,   Adjusted R-squared:  0.04442 \r\nF-statistic: 31.42 on 3 and 1960 DF,  p-value: < 2.2e-16\r\n\r\nlm(clay ~ soilseries, data = database.cleaned) %>% summary() # check at Multiple R square 0.1495\r\n\r\n\r\n\r\nCall:\r\nlm(formula = clay ~ soilseries, data = database.cleaned)\r\n\r\nResiduals:\r\n     Min       1Q   Median       3Q      Max \r\n-20.1870  -4.8709  -0.2771   4.1072  25.3130 \r\n\r\nCoefficients:\r\n              Estimate Std. Error t value Pr(>|t|)    \r\n(Intercept)    16.9771     1.0179  16.678  < 2e-16 ***\r\nsoilseriesCr    8.0451     1.9492   4.127 3.82e-05 ***\r\nsoilseriesHc   -1.1271     1.6095  -0.700 0.483834    \r\nsoilseriesHd    4.0165     1.1014   3.647 0.000273 ***\r\nsoilseriesKp    2.7565     1.1796   2.337 0.019549 *  \r\nsoilseriesLp    5.1276     1.1381   4.506 7.01e-06 ***\r\nsoilseriesLy   -3.6571     3.3141  -1.103 0.269949    \r\nsoilseriesMi   14.7729     3.6701   4.025 5.91e-05 ***\r\nsoilseriesMkn   2.1158     1.3216   1.601 0.109561    \r\nsoilseriesMr   -2.1210     1.4997  -1.414 0.157452    \r\nsoilseriesMs    6.5591     1.4472   4.532 6.19e-06 ***\r\nsoilseriesMt    1.5545     1.9115   0.813 0.416182    \r\nsoilseriesMta  -1.0823     1.9115  -0.566 0.571302    \r\nsoilseriesNa    4.9447     1.1640   4.248 2.26e-05 ***\r\nsoilseriesPae  -0.6464     1.3036  -0.496 0.620034    \r\nsoilseriesPh    6.9890     1.1520   6.067 1.56e-09 ***\r\nsoilseriesSai  -1.7999     1.1491  -1.566 0.117410    \r\nsoilseriesSC   -0.1021     2.2761  -0.045 0.964232    \r\nsoilseriesSkt   7.5099     1.1658   6.442 1.48e-10 ***\r\nsoilseriesSp    3.1703     1.9115   1.659 0.097370 .  \r\nsoilseriesTph   4.0938     1.1565   3.540 0.000410 ***\r\nsoilseriesU     4.9962     1.4633   3.414 0.000653 ***\r\nsoilseriesWch   2.7467     1.8451   1.489 0.136746    \r\nsoilseriesWs    2.0829     1.3930   1.495 0.135004    \r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 7.052 on 1940 degrees of freedom\r\nMultiple R-squared:  0.1493,    Adjusted R-squared:  0.1392 \r\nF-statistic: 14.81 on 23 and 1940 DF,  p-value: < 2.2e-16\r\n\r\nTo quantify the extent of intraspecific vs. interspecific variation of soil properties along the soil categories, we performed a variance partitioning analysis. This analysis assesses the variation in properties at different soil categories (i.e., within-samples, soil series, and soil suit) and between sites (populations) across the elevation gradient. We log transformed the data for the multiplicative soil properties (i.e., pH, OM, P and K) of all non-experimental samples and performed a nested ANOVA using the lme and varcomp functions in R.\r\nFor each level, the function first calculates the group mean. It then compares the variance around the group mean to the mean of the next level (e.g., variance of suitable soil level is compared to the mean of family level). We used taxonomy as a substitute for phylogeny in the analysis. As a result, trait variance may be influenced by the loss of information about the ages of species, genera, families, and orders in relation to each other.\r\n\r\n\r\nlibrary(nlme)\r\nlibrary(ape)\r\n\r\nlme(pH ~ 1,\r\n  random = ~ 1 | suit / soilseries,\r\n  data = database.cleaned\r\n) %>% varcomp(., scale = TRUE, cum = FALSE) -> pH_varcomp\r\n\r\n\r\nlme(om ~ 1,\r\n  random = ~ 1 | suit / soilseries,\r\n  data = database.cleaned\r\n) %>% varcomp(., scale = TRUE, cum = FALSE) -> om_varcomp\r\n\r\n# P is not normal distributed\r\nlme(log(P) ~ 1,\r\n  random = ~ 1 | suit / soilseries,\r\n  data = database.cleaned\r\n) %>% varcomp(., scale = TRUE, cum = FALSE) -> p_varcomp\r\n\r\nlme(log(K) ~ 1,\r\n  random = ~ 1 | suit / soilseries,\r\n  data = database.cleaned\r\n) %>% varcomp(., scale = TRUE, cum = FALSE) -> k_varcomp\r\n\r\nvar <- tibble(\r\n  soil_level = c(\"suit\", \"soilseries\", \"within\"),\r\n  pH = pH_varcomp * 100,\r\n  OM = om_varcomp * 100,\r\n  P = p_varcomp * 100,\r\n  K = k_varcomp * 100\r\n)\r\n\r\nvar\r\n\r\n\r\n# A tibble: 3 x 5\r\n  soil_level    pH          OM     P           K\r\n  <chr>      <dbl>       <dbl> <dbl>       <dbl>\r\n1 suit        1.10  0.00000190  2.93  0.00000227\r\n2 soilseries 11.1  17.9        23.4  21.3       \r\n3 within     87.8  82.1        73.6  78.7       \r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-20-soil-analysis/soil-analysis_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-04-20T12:59:06+07:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "posts/2021-03-30-colorful-of-graph-life/",
    "title": "colorful of graph life",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Sith Jaisong",
        "url": {}
      }
    ],
    "date": "2021-03-30",
    "categories": [],
    "contents": "\r\nslide\r\nbrewer wesanderson \r\n\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\nLearn more about using Distill at https://rstudio.github.io/distill.\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-03-30T10:25:20+07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-17-EDAinR/",
    "title": "EDA in R",
    "description": "Let look at EDA in R",
    "author": [
      {
        "name": "Sith Jaisong",
        "url": {}
      }
    ],
    "date": "2021-03-16",
    "categories": [
      "Rstat"
    ],
    "contents": "\r\n\r\nContents\r\nEDA\r\n\r\nEDA\r\nExploratory data analysis\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-03-31T16:16:19+07:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-03-17-homogeneitytestinr/",
    "title": "Homogeneity test in R",
    "description": "first before going to do ANOVA",
    "author": [
      {
        "name": "Sith Jaisong",
        "url": {}
      }
    ],
    "date": "2021-03-16",
    "categories": [
      "Rstat"
    ],
    "contents": "\r\n\r\nContents\r\nทำไมต้องวิเคราะห์\r\nF-test\r\nBartlett’s test\r\nLevene’s test\r\nFligner-Killeen’s test\r\n\r\n\r\nทำไมต้องวิเคราะห์\r\nก่อนที่เราจะทำการวิเคราะห์ ANOVA เราจะต้องตรวจ ว่า assumption ของ ANOVA นั้น ผ่านหรือไม่ เมื่อเราต้องการเปรียบเทียบ กลุ่มตัวอย่าง 2 กลุ่ม หรือ มากกว่า ว่ามีค่าเฉลี่ยแตกต่างกันหรือไม่ทางสถิติ (ผมไม่ได้เป็นนักสถิติจริงจัง ผมเอาแค่ใช้งาน ดังนั้นต่อไปนี้อ่านไว้เฉยๆ อย่าไปอางอิงอะไรนะครับ)\r\nความแปรปรวนต้องไม่แตกต่างกันอย่างมีนัยทางสถิติ นั้นก็คือ ไอ้เขาสองลูกนี้ ควรจะไม่แตกต่างกันมากนัก ถึงจะเอามาเปรียบเทียบกันได้ จริงไหม แล้วจะรู้ได้อย่างไร สมมุติ มี การทดลอง ชื่อ F10 กับ F50 วัดผลออกมาดังนี้ ผมเอาตัวอย่างข้อมูลจากหนังสือชื่อ สถิติ:การวางแผนการทดลองและการวิเคราะห์ข้อมูลในงานวิจัยด้านพืชด้วย R ของ ชูศักดิ์ จอมพุก\r\n\r\n\r\nF10 <- c(605, 583, 592, 602, 587, 595, 615, 612, 606)\r\nF50 <- c(779, 780, 797, 779, 778, 801, 785, 779, 771)\r\ntest_data <- data.frame(F10, F50)\r\n\r\n\r\n\r\nแล้วจะได้รูปแบบของข้อมูลแบบนี้มา\r\n\r\n\r\ntest_data\r\n\r\n\r\n  F10 F50\r\n1 605 779\r\n2 583 780\r\n3 592 797\r\n4 602 779\r\n5 587 778\r\n6 595 801\r\n7 615 785\r\n8 612 779\r\n9 606 771\r\n\r\nบอกเลยว่า มันไม่ใช่โครงสร้างที่เราจะเหมาะจะมาวิเคราะห์ เลย หรือเอามาทำอะไรต่อ วิธีการ โดยการขอใช้ gather() จาก tidyverse package\r\n\r\n\r\nlibrary(tidyverse)\r\ntidy_data <- test_data %>% gather(key = \"trt\", value = \"yield\")\r\ntidy_data\r\n\r\n\r\n   trt yield\r\n1  F10   605\r\n2  F10   583\r\n3  F10   592\r\n4  F10   602\r\n5  F10   587\r\n6  F10   595\r\n7  F10   615\r\n8  F10   612\r\n9  F10   606\r\n10 F50   779\r\n11 F50   780\r\n12 F50   797\r\n13 F50   779\r\n14 F50   778\r\n15 F50   801\r\n16 F50   785\r\n17 F50   779\r\n18 F50   771\r\n\r\nแบบนี้มันถึงจะไปต่อแล้วรู้เรื่องการเชคความแปรปรวนนั้นมีหลายวิธี\r\nF-test\r\nทดสอบได้แค่ 2 กลุ่ม เท่านั้น\r\n\r\n\r\nvar.test(yield ~ trt, data = tidy_data)\r\n\r\n\r\n\r\n    F test to compare two variances\r\n\r\ndata:  yield by trt\r\nF = 1.3074, num df = 8, denom df = 8, p-value = 0.7137\r\nalternative hypothesis: true ratio of variances is not equal to 1\r\n95 percent confidence interval:\r\n 0.2949165 5.7962277\r\nsample estimates:\r\nratio of variances \r\n          1.307441 \r\n\r\nBartlett’s test\r\nอันนี้ แนะนำ ถ้านึกอะไรไม่ออก ให้นึกถึงอันนี้เลย โดยทั่วไปก็ใช้อันนี้กัน\r\n\r\n\r\nbartlett.test(yield ~ trt, data = tidy_data)\r\n\r\n\r\n\r\n    Bartlett test of homogeneity of variances\r\n\r\ndata:  yield by trt\r\nBartlett's K-squared = 0.13487, df = 1, p-value = 0.7134\r\n\r\nเห็นไหมว่าผลมันก็ใกล้เคียงกัน\r\nLevene’s test\r\nอันนี้ใช้ใน SPSS ใน R ก็จะมีใน car package\r\n\r\n\r\nlibrary(car)\r\nleveneTest(yield ~ trt, data = tidy_data)\r\n\r\n\r\nLevene's Test for Homogeneity of Variance (center = median)\r\n      Df F value Pr(>F)\r\ngroup  1  0.6448 0.4337\r\n      16               \r\n\r\np มันจะต่างออก แต่ก็ไม่ต่างกันซะทีเดียว\r\nFligner-Killeen’s test\r\nวิธีนี้ ค่อนข้างจะ robust กว่าวิธีอื่นๆ ถึงแม้ว่าจะมีการกระจายไม่ค่อยจะ normal เท่าไหร่\r\n\r\n\r\nfligner.test(yield ~ trt, data = tidy_data)\r\n\r\n\r\n\r\n    Fligner-Killeen test of homogeneity of variances\r\n\r\ndata:  yield by trt\r\nFligner-Killeen:med chi-squared = 0.61691, df = 1, p-value =\r\n0.4322\r\n\r\nส่วนตัวไม่ติด ว่าจะใช้วิธีไหน แต่ขอให้บอกว่า ใช้อะไรทดสอบก็ พอ จำไว้ว่าถ้า Homogeneity of Variance ไม่ผ่านแล้ว assumption ของ parametric test ก็ไม่ผ่านเช่นกัน อาจจะต้องหันไปใช้วิธี Nonparametric test แทน\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-03-17-homogeneitytestinr/images/homogeneous-cartoon.jpg",
    "last_modified": "2021-03-17T17:16:17+07:00",
    "input_file": {}
  }
]
